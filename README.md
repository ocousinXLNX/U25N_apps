# U25N DFX

## Repo overview
| Folder	| Description                                                                    |
|---------- | -------------------------------------------------------------------------------|
| scripts	| contains all scripts and sources to create new dynamic projects and build them |
| static	| contains the routed static design needed to generate the partial bitstream     |
| dynamic	| contains all the custom dynamic projects                                       |
| misc		| contains boot image, driver and misc utilities                                 |
| hls 		| contains all hls projects                                                      |
| IP		| contains IP's that can be used in the dynamic projects. Can be generated by hls|

## Usage

#### Before cloning this repository
git lfs should be installed, see [git lfs](https://git-lfs.github.com/)

### Vivado Projects in the Dynamic folder
#### Creating a new project

Go to the `dynamic` folder and execute the following:
```
vivado -mode batch -source ../scripts/u25n_create_dynamic_project.tcl -tclargs --project_name <new_name>
```
This creates an new folder for the project. There you can add any customization etc.

#### Use an existing project

Copy the existing project to the `dynamic` folder (or rather archive and extract project). The folder structure should be `dynamic/<folder_name>/<project_name>.xpr`

If `<folder_name>` is different from `<project_name>` then copy the `<repo_path>/scripts/projectsettings.tcl` file into the `<repo_path>/<folder_name>` directory, and uncomment the `set ProjectName fpga` and modify fpga with whatever `<project_name>` your project has.

#### Project Build flow Customization

You can add a `projectsettings.tcl` file to your project folder (template in `<repo_path>/scripts/projectsettings.tcl`) and uncomment/modify as needed

#### Build design

Run this from the projects commandline:
```
vivado -mode batch -source ../../scripts/u25n_build_all.tcl
```

#### Add a new project to git
If you create or add a new DFX project to the dynamic folder, and want to add this to the repo, just add the `<projectname>.xpr`, the `<projectname>.srcs` folder, and if used the `projectsettings.tcl` file.

### Vitis HLS projects
Each project can have it's own `hls_projectsettings.tcl` (template in `<repo_path>/scripts/hls_projectsettings.tcl`) to uncomment and customize as needed.

To build an HLS project, run this from your hls project folder:
```
vitis_hls -f ../../scripts/run_hls.tcl
```
This will run the hls synthesis, export the IP core, and install it in the `<repo_path>/IP` folder so it can be used by any Dynamic Vivado project
